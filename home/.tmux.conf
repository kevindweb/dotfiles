# ============================================
# SANE DEFAULTS
# ============================================

# Start windows and panes at 1, not 0 (easier to reach)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase scrollback buffer
set -g history-limit 50000

# Faster command sequences (no delay for escape)
set -s escape-time 0

# Increase display time for messages
set -g display-time 2000

# Refresh status more often
set -g status-interval 5

# Focus events for vim/neovim
set -g focus-events on

# ============================================
# MOUSE SUPPORT
# ============================================

# Mouse disabled - use terminal's native selection/copy
# Enter scroll/copy mode with prefix + [
set -g mouse off

# ============================================
# QUICK SPLITS (intuitive keys)
# ============================================

# Split panes using | and - (keeps current path)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Also bind \ for | without shift
bind \\ split-window -h -c "#{pane_current_path}"

# New window keeps current path
bind c new-window -c "#{pane_current_path}"

# ============================================
# COPY/PASTE (vi-mode + system clipboard)
# ============================================

# Use vi keys in copy mode
setw -g mode-keys vi

# Enter copy mode with prefix + [
# v to start selection, y to yank to system clipboard
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"

# ============================================
# RELOAD CONFIG
# ============================================

# Easy reload with prefix + r
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# ============================================
# SESH INTEGRATION
# ============================================

# Ctrl-a K opens sesh picker (session manager)
bind-key K run-shell "sesh connect \"$(
  sesh list --icons | fzf-tmux -p 80%,70% \
    --no-sort --ansi --border-label ' sesh ' --prompt '> ' \
    --header '  ^a all ^t tmux ^g configs ^x zoxide ^d tmux kill ^f find' \
    --bind 'tab:down,btab:up' \
    --bind 'ctrl-a:change-prompt(> )+reload(sesh list --icons)' \
    --bind 'ctrl-t:change-prompt(> )+reload(sesh list -t --icons)' \
    --bind 'ctrl-g:change-prompt(> )+reload(sesh list -c --icons)' \
    --bind 'ctrl-x:change-prompt(> )+reload(sesh list -z --icons)' \
    --bind 'ctrl-f:change-prompt(> )+reload(fd -H -d 2 -t d -E .Trash . ~)' \
    --bind 'ctrl-d:execute(tmux kill-session -t {2..})+change-prompt(> )+reload(sesh list --icons)' \
    --preview-window 'right:50%' \
    --preview 'sesh preview {}'
)\""

# ============================================
# STATUS BAR THEME (preserved)
# ============================================

# status bar theme
set -g status-bg 'colour235'
set -g status-justify 'centre'
set -g status-left-length '100'
set -g status 'on'
set -g status-right-length '100'
set -g status-left '#[fg=colour232,bg=colour154] #S #[fg=colour154,bg=colour238,nobold,nounderscore,noitalics]#[fg=colour222,bg=colour238] #W #[fg=colour238,bg=colour235,nobold,nounderscore,noitalics]#[fg=colour121,bg=colour235] #(whoami)  #(uptime  | cut -d " " -f 1,2,3) #[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]'
set -g status-right '#[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]#[fg=colour121,bg=colour235] %r  %a  %Y #[fg=colour238,bg=colour235,nobold,nounderscore,noitalics]#[fg=colour222,bg=colour238] #H #[fg=colour154,bg=colour238,nobold,nounderscore,noitalics]#[fg=colour232,bg=colour154] #(rainbarf --battery --remaining --no-rgb) '
setw -g window-status-format '#[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]#[default] #I  #W #[fg=colour235,bg=colour235,nobold,nounderscore,noitalics]'
setw -g window-status-current-format '#[fg=colour235,bg=colour238,nobold,nounderscore,noitalics]#[fg=colour222,bg=colour238] #I  #W  #F #[fg=colour238,bg=colour235,nobold,nounderscore,noitalics]'
bind -n C-k clear-history
